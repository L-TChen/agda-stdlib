<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Product.Effectful.Right</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Right-biased universe-sensitive functor and monad instances for the</a>
<a id="177" class="Comment">-- Product type.</a>
<a id="194" class="Comment">--</a>
<a id="197" class="Comment">-- To minimize the universe level of the RawFunctor, we require that</a>
<a id="266" class="Comment">-- elements of B are &quot;lifted&quot; to a copy of B at a higher universe level</a>
<a id="338" class="Comment">-- (a ⊔ b). See the Data.Product.Effectful.Examples for how this is</a>
<a id="406" class="Comment">-- done.</a>
<a id="415" class="Comment">------------------------------------------------------------------------</a>

<a id="489" class="Symbol">{-#</a> <a id="493" class="Keyword">OPTIONS</a> <a id="501" class="Pragma">--cubical-compatible</a> <a id="522" class="Pragma">--safe</a> <a id="529" class="Symbol">#-}</a>

<a id="534" class="Keyword">open</a> <a id="539" class="Keyword">import</a> <a id="546" href="Algebra.html" class="Module">Algebra</a>
<a id="554" class="Keyword">open</a> <a id="559" class="Keyword">import</a> <a id="566" href="Level.html" class="Module">Level</a>

<a id="573" class="Keyword">module</a> <a id="580" href="Data.Product.Effectful.Right.html" class="Module">Data.Product.Effectful.Right</a>
  <a id="611" class="Symbol">(</a><a id="612" href="Data.Product.Effectful.Right.html#612" class="Bound">a</a> <a id="614" class="Symbol">:</a> <a id="616" href="Agda.Primitive.html#591" class="Postulate">Level</a><a id="621" class="Symbol">)</a> <a id="623" class="Symbol">{</a><a id="624" href="Data.Product.Effectful.Right.html#624" class="Bound">b</a> <a id="626" href="Data.Product.Effectful.Right.html#626" class="Bound">e</a><a id="627" class="Symbol">}</a> <a id="629" class="Symbol">(</a><a id="630" href="Data.Product.Effectful.Right.html#630" class="Bound">B</a> <a id="632" class="Symbol">:</a> <a id="634" href="Algebra.Bundles.Raw.html#1105" class="Record">RawMonoid</a> <a id="644" href="Data.Product.Effectful.Right.html#624" class="Bound">b</a> <a id="646" href="Data.Product.Effectful.Right.html#626" class="Bound">e</a><a id="647" class="Symbol">)</a> <a id="649" class="Keyword">where</a>

<a id="656" class="Keyword">open</a> <a id="661" class="Keyword">import</a> <a id="668" href="Data.Product.html" class="Module">Data.Product</a>
<a id="681" class="Keyword">import</a> <a id="688" href="Data.Product.Effectful.Right.Base.html" class="Module">Data.Product.Effectful.Right.Base</a> <a id="722" class="Symbol">as</a> <a id="725" class="Module">Base</a>
<a id="730" class="Keyword">open</a> <a id="735" class="Keyword">import</a> <a id="742" href="Effect.Applicative.html" class="Module">Effect.Applicative</a> <a id="761" class="Keyword">using</a> <a id="767" class="Symbol">(</a><a id="768" href="Effect.Applicative.html#979" class="Record">RawApplicative</a><a id="782" class="Symbol">)</a>
<a id="784" class="Keyword">open</a> <a id="789" class="Keyword">import</a> <a id="796" href="Effect.Monad.html" class="Module">Effect.Monad</a> <a id="809" class="Keyword">using</a> <a id="815" class="Symbol">(</a><a id="816" href="Effect.Monad.html#775" class="Record">RawMonad</a><a id="824" class="Symbol">;</a> <a id="826" href="Effect.Monad.html#3048" class="Function">RawMonadT</a><a id="835" class="Symbol">;</a> <a id="837" href="Effect.Monad.html#1512" class="Function">mkRawMonad</a><a id="847" class="Symbol">)</a>
<a id="849" class="Keyword">open</a> <a id="854" class="Keyword">import</a> <a id="861" href="Function.Base.html" class="Module">Function.Base</a> <a id="875" class="Keyword">using</a> <a id="881" class="Symbol">(</a><a id="882" href="Function.Base.html#704" class="Function">id</a><a id="884" class="Symbol">;</a> <a id="886" href="Function.Base.html#1638" class="Function">flip</a><a id="890" class="Symbol">;</a> <a id="892" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="895" class="Symbol">;</a> <a id="897" href="Function.Base.html#3646" class="Function Operator">_∘′_</a><a id="901" class="Symbol">)</a>
<a id="903" class="Keyword">import</a> <a id="910" href="Function.Identity.Effectful.html" class="Module">Function.Identity.Effectful</a> <a id="938" class="Symbol">as</a> <a id="941" class="Module">Id</a>

<a id="945" class="Keyword">open</a> <a id="950" href="Algebra.Bundles.Raw.html#1105" class="Module">RawMonoid</a> <a id="960" href="Data.Product.Effectful.Right.html#630" class="Bound">B</a>

<a id="963" class="Comment">------------------------------------------------------------------------</a>
<a id="1036" class="Comment">-- Re-export the base contents publically</a>

<a id="1079" class="Keyword">open</a> <a id="1084" href="Data.Product.Effectful.Right.Base.html" class="Module">Base</a> <a id="1089" href="Algebra.Bundles.Raw.html#1187" class="Field">Carrier</a> <a id="1097" href="Data.Product.Effectful.Right.html#612" class="Bound">a</a> <a id="1099" class="Keyword">public</a>

<a id="1107" class="Comment">------------------------------------------------------------------------</a>
<a id="1180" class="Comment">-- Basic records</a>

<a id="applicative"></a><a id="1198" href="Data.Product.Effectful.Right.html#1198" class="Function">applicative</a> <a id="1210" class="Symbol">:</a> <a id="1212" href="Effect.Applicative.html#979" class="Record">RawApplicative</a> <a id="1227" href="Data.Product.Effectful.Right.Base.html#902" class="Function">Productᵣ</a>
<a id="1236" href="Data.Product.Effectful.Right.html#1198" class="Function">applicative</a> <a id="1248" class="Symbol">=</a> <a id="1250" class="Keyword">record</a>
  <a id="1259" class="Symbol">{</a> <a id="1261" href="Effect.Applicative.html#1117" class="Field">rawFunctor</a> <a id="1272" class="Symbol">=</a> <a id="1274" href="Data.Product.Effectful.Right.Base.html#959" class="Function">functor</a>
  <a id="1284" class="Symbol">;</a> <a id="1286" href="Effect.Applicative.html#1147" class="Field">pure</a> <a id="1291" class="Symbol">=</a> <a id="1293" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,</a> <a id="1296" href="Algebra.Bundles.Raw.html#1261" class="Field">ε</a>
  <a id="1300" class="Symbol">;</a> <a id="1302" href="Effect.Applicative.html#1166" class="Field Operator">_&lt;*&gt;_</a>  <a id="1309" class="Symbol">=</a> <a id="1311" href="Data.Product.Base.html#2247" class="Function">zip</a> <a id="1315" href="Function.Base.html#704" class="Function">id</a> <a id="1318" href="Algebra.Bundles.Raw.html#1235" class="Field Operator">_∙_</a>
  <a id="1324" class="Symbol">}</a>

<a id="monad"></a><a id="1327" href="Data.Product.Effectful.Right.html#1327" class="Function">monad</a> <a id="1333" class="Symbol">:</a> <a id="1335" href="Effect.Monad.html#775" class="Record">RawMonad</a> <a id="1344" href="Data.Product.Effectful.Right.Base.html#902" class="Function">Productᵣ</a>
<a id="1353" href="Data.Product.Effectful.Right.html#1327" class="Function">monad</a> <a id="1359" class="Symbol">=</a> <a id="1361" class="Keyword">record</a>
  <a id="1370" class="Symbol">{</a> <a id="1372" href="Effect.Monad.html#891" class="Field">rawApplicative</a> <a id="1387" class="Symbol">=</a> <a id="1389" href="Data.Product.Effectful.Right.html#1198" class="Function">applicative</a>
  <a id="1403" class="Symbol">;</a> <a id="1405" href="Effect.Monad.html#929" class="Field Operator">_&gt;&gt;=_</a> <a id="1411" class="Symbol">=</a> <a id="1413" href="Data.Product.Base.html#2609" class="Function">uncurry</a> <a id="1421" class="Symbol">λ</a> <a id="1423" href="Data.Product.Effectful.Right.html#1423" class="Bound">a</a> <a id="1425" href="Data.Product.Effectful.Right.html#1425" class="Bound">w₁</a> <a id="1428" href="Data.Product.Effectful.Right.html#1428" class="Bound">f</a> <a id="1430" class="Symbol">→</a> <a id="1432" href="Data.Product.Base.html#1862" class="Function">map₂</a> <a id="1437" class="Symbol">(</a><a id="1438" href="Data.Product.Effectful.Right.html#1425" class="Bound">w₁</a> <a id="1441" href="Algebra.Bundles.Raw.html#1235" class="Field Operator">∙_</a><a id="1443" class="Symbol">)</a> <a id="1445" class="Symbol">(</a><a id="1446" href="Data.Product.Effectful.Right.html#1428" class="Bound">f</a> <a id="1448" href="Data.Product.Effectful.Right.html#1423" class="Bound">a</a><a id="1449" class="Symbol">)</a>
  <a id="1453" class="Symbol">}</a>

<a id="monadT"></a><a id="1456" href="Data.Product.Effectful.Right.html#1456" class="Function">monadT</a> <a id="1463" class="Symbol">:</a> <a id="1465" href="Effect.Monad.html#3048" class="Function">RawMonadT</a> <a id="1475" class="Symbol">(</a><a id="1476" href="Function.Base.html#3646" class="Function Operator">_∘′</a> <a id="1480" href="Data.Product.Effectful.Right.Base.html#902" class="Function">Productᵣ</a><a id="1488" class="Symbol">)</a>
<a id="1490" href="Data.Product.Effectful.Right.html#1456" class="Function">monadT</a> <a id="1497" href="Data.Product.Effectful.Right.html#1497" class="Bound">M</a> <a id="1499" class="Symbol">=</a> <a id="1501" class="Keyword">record</a>
  <a id="1510" class="Symbol">{</a> <a id="1512" href="Effect.Monad.html#2969" class="Field">lift</a> <a id="1517" class="Symbol">=</a> <a id="1519" class="Symbol">(</a><a id="1520" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,</a> <a id="1523" href="Algebra.Bundles.Raw.html#1261" class="Field">ε</a><a id="1524" class="Symbol">)</a> <a id="1526" href="Effect.Functor.html#687" class="Function Operator">&lt;$&gt;_</a>
  <a id="1533" class="Symbol">;</a> <a id="1535" href="Effect.Monad.html#2991" class="Field">rawMonad</a> <a id="1544" class="Symbol">=</a> <a id="1546" href="Effect.Monad.html#1512" class="Function">mkRawMonad</a> <a id="1557" class="Symbol">_</a>
                 <a id="1576" class="Symbol">(</a><a id="1577" href="Effect.Applicative.html#1147" class="Function">pure</a> <a id="1582" href="Function.Base.html#3646" class="Function Operator">∘′</a> <a id="1585" class="Symbol">(</a><a id="1586" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,</a> <a id="1589" href="Algebra.Bundles.Raw.html#1261" class="Field">ε</a><a id="1590" class="Symbol">))</a>
                 <a id="1610" class="Symbol">(λ</a> <a id="1613" href="Data.Product.Effectful.Right.html#1613" class="Bound">ma</a> <a id="1616" href="Data.Product.Effectful.Right.html#1616" class="Bound">f</a> <a id="1618" class="Symbol">→</a> <a id="1620" href="Data.Product.Effectful.Right.html#1613" class="Bound">ma</a> <a id="1623" href="Effect.Monad.html#929" class="Field Operator">&gt;&gt;=</a> <a id="1627" href="Data.Product.Base.html#2609" class="Function">uncurry</a> <a id="1635" class="Symbol">λ</a> <a id="1637" href="Data.Product.Effectful.Right.html#1637" class="Bound">x</a> <a id="1639" href="Data.Product.Effectful.Right.html#1639" class="Bound">b</a> <a id="1641" class="Symbol">→</a> <a id="1643" href="Data.Product.Base.html#1862" class="Function">map₂</a> <a id="1648" class="Symbol">(</a><a id="1649" href="Data.Product.Effectful.Right.html#1639" class="Bound">b</a> <a id="1651" href="Algebra.Bundles.Raw.html#1235" class="Field Operator">∙_</a><a id="1653" class="Symbol">)</a> <a id="1655" href="Effect.Functor.html#687" class="Function Operator">&lt;$&gt;</a> <a id="1659" href="Data.Product.Effectful.Right.html#1616" class="Bound">f</a> <a id="1661" href="Data.Product.Effectful.Right.html#1637" class="Bound">x</a><a id="1662" class="Symbol">)</a>
  <a id="1666" class="Symbol">}</a> <a id="1668" class="Keyword">where</a> <a id="1674" class="Keyword">open</a> <a id="1679" href="Effect.Monad.html#775" class="Module">RawMonad</a> <a id="1688" href="Data.Product.Effectful.Right.html#1497" class="Bound">M</a>

<a id="1691" class="Comment">------------------------------------------------------------------------</a>
<a id="1764" class="Comment">-- Get access to other monadic functions</a>

<a id="1806" class="Keyword">module</a> <a id="TraversableA"></a><a id="1813" href="Data.Product.Effectful.Right.html#1813" class="Module">TraversableA</a> <a id="1826" class="Symbol">{</a><a id="1827" href="Data.Product.Effectful.Right.html#1827" class="Bound">F</a><a id="1828" class="Symbol">}</a> <a id="1830" class="Symbol">(</a><a id="1831" href="Data.Product.Effectful.Right.html#1831" class="Bound">App</a> <a id="1835" class="Symbol">:</a> <a id="1837" href="Effect.Applicative.html#979" class="Record">RawApplicative</a> <a id="1852" class="Symbol">{</a><a id="1853" href="Data.Product.Effectful.Right.html#612" class="Bound">a</a> <a id="1855" href="Agda.Primitive.html#804" class="Primitive Operator">⊔</a> <a id="1857" href="Data.Product.Effectful.Right.html#624" class="Bound">b</a><a id="1858" class="Symbol">}</a> <a id="1860" class="Symbol">{</a><a id="1861" href="Data.Product.Effectful.Right.html#612" class="Bound">a</a> <a id="1863" href="Agda.Primitive.html#804" class="Primitive Operator">⊔</a> <a id="1865" href="Data.Product.Effectful.Right.html#624" class="Bound">b</a><a id="1866" class="Symbol">}</a> <a id="1868" href="Data.Product.Effectful.Right.html#1827" class="Bound">F</a><a id="1869" class="Symbol">)</a> <a id="1871" class="Keyword">where</a>

  <a id="1880" class="Keyword">open</a> <a id="1885" href="Effect.Applicative.html#979" class="Module">RawApplicative</a> <a id="1900" href="Data.Product.Effectful.Right.html#1831" class="Bound">App</a>

  <a id="TraversableA.sequenceA"></a><a id="1907" href="Data.Product.Effectful.Right.html#1907" class="Function">sequenceA</a> <a id="1917" class="Symbol">:</a> <a id="1919" class="Symbol">∀</a> <a id="1921" class="Symbol">{</a><a id="1922" href="Data.Product.Effectful.Right.html#1922" class="Bound">A</a><a id="1923" class="Symbol">}</a> <a id="1925" class="Symbol">→</a> <a id="1927" href="Data.Product.Effectful.Right.Base.html#902" class="Function">Productᵣ</a> <a id="1936" class="Symbol">(</a><a id="1937" href="Data.Product.Effectful.Right.html#1827" class="Bound">F</a> <a id="1939" href="Data.Product.Effectful.Right.html#1922" class="Bound">A</a><a id="1940" class="Symbol">)</a> <a id="1942" class="Symbol">→</a> <a id="1944" href="Data.Product.Effectful.Right.html#1827" class="Bound">F</a> <a id="1946" class="Symbol">(</a><a id="1947" href="Data.Product.Effectful.Right.Base.html#902" class="Function">Productᵣ</a> <a id="1956" href="Data.Product.Effectful.Right.html#1922" class="Bound">A</a><a id="1957" class="Symbol">)</a>
  <a id="1961" href="Data.Product.Effectful.Right.html#1907" class="Function">sequenceA</a> <a id="1971" class="Symbol">(</a><a id="1972" href="Data.Product.Effectful.Right.html#1972" class="Bound">fa</a> <a id="1975" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1977" href="Data.Product.Effectful.Right.html#1977" class="Bound">y</a><a id="1978" class="Symbol">)</a> <a id="1980" class="Symbol">=</a> <a id="1982" class="Symbol">(</a><a id="1983" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,</a> <a id="1986" href="Data.Product.Effectful.Right.html#1977" class="Bound">y</a><a id="1987" class="Symbol">)</a> <a id="1989" href="Effect.Functor.html#687" class="Function Operator">&lt;$&gt;</a> <a id="1993" href="Data.Product.Effectful.Right.html#1972" class="Bound">fa</a>

  <a id="TraversableA.mapA"></a><a id="1999" href="Data.Product.Effectful.Right.html#1999" class="Function">mapA</a> <a id="2004" class="Symbol">:</a> <a id="2006" class="Symbol">∀</a> <a id="2008" class="Symbol">{</a><a id="2009" href="Data.Product.Effectful.Right.html#2009" class="Bound">A</a> <a id="2011" href="Data.Product.Effectful.Right.html#2011" class="Bound">B</a><a id="2012" class="Symbol">}</a> <a id="2014" class="Symbol">→</a> <a id="2016" class="Symbol">(</a><a id="2017" href="Data.Product.Effectful.Right.html#2009" class="Bound">A</a> <a id="2019" class="Symbol">→</a> <a id="2021" href="Data.Product.Effectful.Right.html#1827" class="Bound">F</a> <a id="2023" href="Data.Product.Effectful.Right.html#2011" class="Bound">B</a><a id="2024" class="Symbol">)</a> <a id="2026" class="Symbol">→</a> <a id="2028" href="Data.Product.Effectful.Right.Base.html#902" class="Function">Productᵣ</a> <a id="2037" href="Data.Product.Effectful.Right.html#2009" class="Bound">A</a> <a id="2039" class="Symbol">→</a> <a id="2041" href="Data.Product.Effectful.Right.html#1827" class="Bound">F</a> <a id="2043" class="Symbol">(</a><a id="2044" href="Data.Product.Effectful.Right.Base.html#902" class="Function">Productᵣ</a> <a id="2053" href="Data.Product.Effectful.Right.html#2011" class="Bound">B</a><a id="2054" class="Symbol">)</a>
  <a id="2058" href="Data.Product.Effectful.Right.html#1999" class="Function">mapA</a> <a id="2063" href="Data.Product.Effectful.Right.html#2063" class="Bound">f</a> <a id="2065" class="Symbol">=</a> <a id="2067" href="Data.Product.Effectful.Right.html#1907" class="Function">sequenceA</a> <a id="2077" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2079" href="Data.Product.Base.html#1812" class="Function">map₁</a> <a id="2084" href="Data.Product.Effectful.Right.html#2063" class="Bound">f</a>

  <a id="TraversableA.forA"></a><a id="2089" href="Data.Product.Effectful.Right.html#2089" class="Function">forA</a> <a id="2094" class="Symbol">:</a> <a id="2096" class="Symbol">∀</a> <a id="2098" class="Symbol">{</a><a id="2099" href="Data.Product.Effectful.Right.html#2099" class="Bound">A</a> <a id="2101" href="Data.Product.Effectful.Right.html#2101" class="Bound">B</a><a id="2102" class="Symbol">}</a> <a id="2104" class="Symbol">→</a> <a id="2106" href="Data.Product.Effectful.Right.Base.html#902" class="Function">Productᵣ</a> <a id="2115" href="Data.Product.Effectful.Right.html#2099" class="Bound">A</a> <a id="2117" class="Symbol">→</a> <a id="2119" class="Symbol">(</a><a id="2120" href="Data.Product.Effectful.Right.html#2099" class="Bound">A</a> <a id="2122" class="Symbol">→</a> <a id="2124" href="Data.Product.Effectful.Right.html#1827" class="Bound">F</a> <a id="2126" href="Data.Product.Effectful.Right.html#2101" class="Bound">B</a><a id="2127" class="Symbol">)</a> <a id="2129" class="Symbol">→</a> <a id="2131" href="Data.Product.Effectful.Right.html#1827" class="Bound">F</a> <a id="2133" class="Symbol">(</a><a id="2134" href="Data.Product.Effectful.Right.Base.html#902" class="Function">Productᵣ</a> <a id="2143" href="Data.Product.Effectful.Right.html#2101" class="Bound">B</a><a id="2144" class="Symbol">)</a>
  <a id="2148" href="Data.Product.Effectful.Right.html#2089" class="Function">forA</a> <a id="2153" class="Symbol">=</a> <a id="2155" href="Function.Base.html#1638" class="Function">flip</a> <a id="2160" href="Data.Product.Effectful.Right.html#1999" class="Function">mapA</a>

<a id="2166" class="Keyword">module</a> <a id="TraversableM"></a><a id="2173" href="Data.Product.Effectful.Right.html#2173" class="Module">TraversableM</a> <a id="2186" class="Symbol">{</a><a id="2187" href="Data.Product.Effectful.Right.html#2187" class="Bound">M</a><a id="2188" class="Symbol">}</a> <a id="2190" class="Symbol">(</a><a id="2191" href="Data.Product.Effectful.Right.html#2191" class="Bound">Mon</a> <a id="2195" class="Symbol">:</a> <a id="2197" href="Effect.Monad.html#775" class="Record">RawMonad</a> <a id="2206" class="Symbol">{</a><a id="2207" href="Data.Product.Effectful.Right.html#612" class="Bound">a</a> <a id="2209" href="Agda.Primitive.html#804" class="Primitive Operator">⊔</a> <a id="2211" href="Data.Product.Effectful.Right.html#624" class="Bound">b</a><a id="2212" class="Symbol">}</a> <a id="2214" class="Symbol">{</a><a id="2215" href="Data.Product.Effectful.Right.html#612" class="Bound">a</a> <a id="2217" href="Agda.Primitive.html#804" class="Primitive Operator">⊔</a> <a id="2219" href="Data.Product.Effectful.Right.html#624" class="Bound">b</a><a id="2220" class="Symbol">}</a> <a id="2222" href="Data.Product.Effectful.Right.html#2187" class="Bound">M</a><a id="2223" class="Symbol">)</a> <a id="2225" class="Keyword">where</a>

  <a id="2234" class="Keyword">open</a> <a id="2239" href="Effect.Monad.html#775" class="Module">RawMonad</a> <a id="2248" href="Data.Product.Effectful.Right.html#2191" class="Bound">Mon</a>

  <a id="2255" class="Keyword">open</a> <a id="2260" href="Data.Product.Effectful.Right.html#1813" class="Module">TraversableA</a> <a id="2273" href="Effect.Monad.html#891" class="Field">rawApplicative</a> <a id="2288" class="Keyword">public</a>
    <a id="2299" class="Keyword">renaming</a>
    <a id="2312" class="Symbol">(</a> <a id="2314" href="Data.Product.Effectful.Right.html#1907" class="Function">sequenceA</a> <a id="2324" class="Symbol">to</a> <a id="2327" class="Function">sequenceM</a>
    <a id="2341" class="Symbol">;</a> <a id="2343" href="Data.Product.Effectful.Right.html#1999" class="Function">mapA</a>      <a id="2353" class="Symbol">to</a> <a id="2356" class="Function">mapM</a>
    <a id="2365" class="Symbol">;</a> <a id="2367" href="Data.Product.Effectful.Right.html#2089" class="Function">forA</a>      <a id="2377" class="Symbol">to</a> <a id="2380" class="Function">forM</a>
    <a id="2389" class="Symbol">)</a>
</pre></body></html>