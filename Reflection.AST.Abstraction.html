<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.AST.Abstraction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Abstractions used in the reflection machinery</a>
<a id="155" class="Comment">------------------------------------------------------------------------</a>

<a id="229" class="Symbol">{-#</a> <a id="233" class="Keyword">OPTIONS</a> <a id="241" class="Pragma">--cubical-compatible</a> <a id="262" class="Pragma">--safe</a> <a id="269" class="Symbol">#-}</a>

<a id="274" class="Keyword">module</a> <a id="281" href="Reflection.AST.Abstraction.html" class="Module">Reflection.AST.Abstraction</a> <a id="308" class="Keyword">where</a>

<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.Product.html" class="Module">Data.Product</a>                          <a id="365" class="Keyword">using</a> <a id="371" class="Symbol">(</a><a id="372" href="Data.Product.Base.html#1118" class="Function Operator">_×_</a><a id="375" class="Symbol">;</a> <a id="377" href="Data.Product.Base.html#1500" class="Function Operator">&lt;_,_&gt;</a><a id="382" class="Symbol">;</a> <a id="384" href="Data.Product.Base.html#2609" class="Function">uncurry</a><a id="391" class="Symbol">)</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Data.String.html" class="Module">Data.String</a> <a id="417" class="Symbol">as</a> <a id="420" class="Module">String</a>                 <a id="443" class="Keyword">using</a> <a id="449" class="Symbol">(</a><a id="450" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="456" class="Symbol">)</a>
<a id="458" class="Keyword">open</a> <a id="463" class="Keyword">import</a> <a id="470" href="Level.html" class="Module">Level</a>
<a id="476" class="Keyword">open</a> <a id="481" class="Keyword">import</a> <a id="488" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>            <a id="526" class="Keyword">using</a> <a id="532" class="Symbol">(</a><a id="533" href="Relation.Nullary.Decidable.Core.html#1485" class="Record">Dec</a><a id="536" class="Symbol">;</a> <a id="538" href="Relation.Nullary.Decidable.Core.html#4788" class="Function">map′</a><a id="542" class="Symbol">;</a> <a id="544" href="Relation.Nullary.Decidable.Core.html#2264" class="Function Operator">_×-dec_</a><a id="551" class="Symbol">)</a>
<a id="553" class="Keyword">open</a> <a id="558" class="Keyword">import</a> <a id="565" href="Relation.Binary.html" class="Module">Relation.Binary</a>                       <a id="603" class="Keyword">using</a> <a id="609" class="Symbol">(</a><a id="610" href="Relation.Binary.Definitions.html#6217" class="Function">DecidableEquality</a><a id="627" class="Symbol">)</a>
<a id="629" class="Keyword">open</a> <a id="634" class="Keyword">import</a> <a id="641" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="679" class="Keyword">using</a> <a id="685" class="Symbol">(</a><a id="686" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="689" class="Symbol">;</a> <a id="691" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="695" class="Symbol">;</a> <a id="697" href="Relation.Binary.PropositionalEquality.Core.html#1390" class="Function">cong₂</a><a id="702" class="Symbol">)</a>

<a id="705" class="Keyword">private</a>
  <a id="715" class="Keyword">variable</a>
    <a id="728" href="Reflection.AST.Abstraction.html#728" class="Generalizable">a</a> <a id="730" href="Reflection.AST.Abstraction.html#730" class="Generalizable">b</a> <a id="732" class="Symbol">:</a> <a id="734" href="Agda.Primitive.html#591" class="Postulate">Level</a>
    <a id="744" href="Reflection.AST.Abstraction.html#744" class="Generalizable">A</a> <a id="746" href="Reflection.AST.Abstraction.html#746" class="Generalizable">B</a> <a id="748" class="Symbol">:</a> <a id="750" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="754" href="Reflection.AST.Abstraction.html#728" class="Generalizable">a</a>
    <a id="760" href="Reflection.AST.Abstraction.html#760" class="Generalizable">s</a> <a id="762" href="Reflection.AST.Abstraction.html#762" class="Generalizable">t</a> <a id="764" class="Symbol">:</a> <a id="766" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
    <a id="777" href="Reflection.AST.Abstraction.html#777" class="Generalizable">x</a> <a id="779" href="Reflection.AST.Abstraction.html#779" class="Generalizable">y</a> <a id="781" class="Symbol">:</a> <a id="783" href="Reflection.AST.Abstraction.html#744" class="Generalizable">A</a>

<a id="786" class="Comment">------------------------------------------------------------------------</a>
<a id="859" class="Comment">-- Re-exporting the builtins publicly</a>

<a id="898" class="Keyword">open</a> <a id="903" class="Keyword">import</a> <a id="910" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="934" class="Keyword">public</a>
  <a id="943" class="Keyword">using</a> <a id="949" class="Symbol">(</a><a id="950" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a><a id="953" class="Symbol">)</a>

<a id="956" class="Keyword">open</a> <a id="961" href="Agda.Builtin.Reflection.html#3926" class="Module">Abs</a> <a id="965" class="Keyword">public</a>

<a id="973" class="Comment">------------------------------------------------------------------------</a>
<a id="1046" class="Comment">-- Operations</a>

<a id="map"></a><a id="1061" href="Reflection.AST.Abstraction.html#1061" class="Function">map</a> <a id="1065" class="Symbol">:</a> <a id="1067" class="Symbol">(</a><a id="1068" href="Reflection.AST.Abstraction.html#744" class="Generalizable">A</a> <a id="1070" class="Symbol">→</a> <a id="1072" href="Reflection.AST.Abstraction.html#746" class="Generalizable">B</a><a id="1073" class="Symbol">)</a> <a id="1075" class="Symbol">→</a> <a id="1077" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1081" href="Reflection.AST.Abstraction.html#744" class="Generalizable">A</a> <a id="1083" class="Symbol">→</a> <a id="1085" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1089" href="Reflection.AST.Abstraction.html#746" class="Generalizable">B</a>
<a id="1091" href="Reflection.AST.Abstraction.html#1061" class="Function">map</a> <a id="1095" href="Reflection.AST.Abstraction.html#1095" class="Bound">f</a> <a id="1097" class="Symbol">(</a><a id="1098" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1102" href="Reflection.AST.Abstraction.html#1102" class="Bound">s</a> <a id="1104" href="Reflection.AST.Abstraction.html#1104" class="Bound">x</a><a id="1105" class="Symbol">)</a> <a id="1107" class="Symbol">=</a> <a id="1109" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1113" href="Reflection.AST.Abstraction.html#1102" class="Bound">s</a> <a id="1115" class="Symbol">(</a><a id="1116" href="Reflection.AST.Abstraction.html#1095" class="Bound">f</a> <a id="1118" href="Reflection.AST.Abstraction.html#1104" class="Bound">x</a><a id="1119" class="Symbol">)</a>

<a id="1122" class="Comment">------------------------------------------------------------------------</a>
<a id="1195" class="Comment">-- Decidable equality</a>

<a id="abs-injective₁"></a><a id="1218" href="Reflection.AST.Abstraction.html#1218" class="Function">abs-injective₁</a> <a id="1233" class="Symbol">:</a> <a id="1235" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1239" href="Reflection.AST.Abstraction.html#760" class="Generalizable">s</a> <a id="1241" href="Reflection.AST.Abstraction.html#777" class="Generalizable">x</a> <a id="1243" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1245" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1249" href="Reflection.AST.Abstraction.html#762" class="Generalizable">t</a> <a id="1251" href="Reflection.AST.Abstraction.html#779" class="Generalizable">y</a> <a id="1253" class="Symbol">→</a> <a id="1255" href="Reflection.AST.Abstraction.html#760" class="Generalizable">s</a> <a id="1257" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1259" href="Reflection.AST.Abstraction.html#762" class="Generalizable">t</a>
<a id="1261" href="Reflection.AST.Abstraction.html#1218" class="Function">abs-injective₁</a> <a id="1276" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="1281" class="Symbol">=</a> <a id="1283" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="abs-injective₂"></a><a id="1289" href="Reflection.AST.Abstraction.html#1289" class="Function">abs-injective₂</a> <a id="1304" class="Symbol">:</a> <a id="1306" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1310" href="Reflection.AST.Abstraction.html#760" class="Generalizable">s</a> <a id="1312" href="Reflection.AST.Abstraction.html#777" class="Generalizable">x</a> <a id="1314" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1316" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1320" href="Reflection.AST.Abstraction.html#762" class="Generalizable">t</a> <a id="1322" href="Reflection.AST.Abstraction.html#779" class="Generalizable">y</a> <a id="1324" class="Symbol">→</a> <a id="1326" href="Reflection.AST.Abstraction.html#777" class="Generalizable">x</a> <a id="1328" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1330" href="Reflection.AST.Abstraction.html#779" class="Generalizable">y</a>
<a id="1332" href="Reflection.AST.Abstraction.html#1289" class="Function">abs-injective₂</a> <a id="1347" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="1352" class="Symbol">=</a> <a id="1354" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="abs-injective"></a><a id="1360" href="Reflection.AST.Abstraction.html#1360" class="Function">abs-injective</a> <a id="1374" class="Symbol">:</a> <a id="1376" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1380" href="Reflection.AST.Abstraction.html#760" class="Generalizable">s</a> <a id="1382" href="Reflection.AST.Abstraction.html#777" class="Generalizable">x</a> <a id="1384" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1386" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1390" href="Reflection.AST.Abstraction.html#762" class="Generalizable">t</a> <a id="1392" href="Reflection.AST.Abstraction.html#779" class="Generalizable">y</a> <a id="1394" class="Symbol">→</a> <a id="1396" href="Reflection.AST.Abstraction.html#760" class="Generalizable">s</a> <a id="1398" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1400" href="Reflection.AST.Abstraction.html#762" class="Generalizable">t</a> <a id="1402" href="Data.Product.Base.html#1118" class="Function Operator">×</a> <a id="1404" href="Reflection.AST.Abstraction.html#777" class="Generalizable">x</a> <a id="1406" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1408" href="Reflection.AST.Abstraction.html#779" class="Generalizable">y</a>
<a id="1410" href="Reflection.AST.Abstraction.html#1360" class="Function">abs-injective</a> <a id="1424" class="Symbol">=</a> <a id="1426" href="Data.Product.Base.html#1500" class="Function Operator">&lt;</a> <a id="1428" href="Reflection.AST.Abstraction.html#1218" class="Function">abs-injective₁</a> <a id="1443" href="Data.Product.Base.html#1500" class="Function Operator">,</a> <a id="1445" href="Reflection.AST.Abstraction.html#1289" class="Function">abs-injective₂</a> <a id="1460" href="Data.Product.Base.html#1500" class="Function Operator">&gt;</a>

<a id="1463" class="Comment">-- We often need decidability of equality for Abs A when implementing it</a>
<a id="1536" class="Comment">-- for A. Unfortunately ≡-dec makes the termination checker unhappy.</a>
<a id="1605" class="Comment">-- Instead, we can match on both Abs A and use unAbs-dec for an obviously</a>
<a id="1679" class="Comment">-- decreasing recursive call.</a>

<a id="unAbs"></a><a id="1710" href="Reflection.AST.Abstraction.html#1710" class="Function">unAbs</a> <a id="1716" class="Symbol">:</a> <a id="1718" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1722" href="Reflection.AST.Abstraction.html#744" class="Generalizable">A</a> <a id="1724" class="Symbol">→</a> <a id="1726" href="Reflection.AST.Abstraction.html#744" class="Generalizable">A</a>
<a id="1728" href="Reflection.AST.Abstraction.html#1710" class="Function">unAbs</a> <a id="1734" class="Symbol">(</a><a id="1735" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1739" href="Reflection.AST.Abstraction.html#1739" class="Bound">s</a> <a id="1741" href="Reflection.AST.Abstraction.html#1741" class="Bound">a</a><a id="1742" class="Symbol">)</a> <a id="1744" class="Symbol">=</a> <a id="1746" href="Reflection.AST.Abstraction.html#1741" class="Bound">a</a>

<a id="unAbs-dec"></a><a id="1749" href="Reflection.AST.Abstraction.html#1749" class="Function">unAbs-dec</a> <a id="1759" class="Symbol">:</a> <a id="1761" class="Symbol">{</a><a id="1762" href="Reflection.AST.Abstraction.html#1762" class="Bound">abs1</a> <a id="1767" href="Reflection.AST.Abstraction.html#1767" class="Bound">abs2</a> <a id="1772" class="Symbol">:</a> <a id="1774" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1778" href="Reflection.AST.Abstraction.html#744" class="Generalizable">A</a><a id="1779" class="Symbol">}</a> <a id="1781" class="Symbol">→</a> <a id="1783" href="Relation.Nullary.Decidable.Core.html#1485" class="Record">Dec</a> <a id="1787" class="Symbol">(</a><a id="1788" href="Reflection.AST.Abstraction.html#1710" class="Function">unAbs</a> <a id="1794" href="Reflection.AST.Abstraction.html#1762" class="Bound">abs1</a> <a id="1799" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1801" href="Reflection.AST.Abstraction.html#1710" class="Function">unAbs</a> <a id="1807" href="Reflection.AST.Abstraction.html#1767" class="Bound">abs2</a><a id="1811" class="Symbol">)</a> <a id="1813" class="Symbol">→</a> <a id="1815" href="Relation.Nullary.Decidable.Core.html#1485" class="Record">Dec</a> <a id="1819" class="Symbol">(</a><a id="1820" href="Reflection.AST.Abstraction.html#1762" class="Bound">abs1</a> <a id="1825" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1827" href="Reflection.AST.Abstraction.html#1767" class="Bound">abs2</a><a id="1831" class="Symbol">)</a>
<a id="1833" href="Reflection.AST.Abstraction.html#1749" class="Function">unAbs-dec</a> <a id="1843" class="Symbol">{</a><a id="1844" class="Argument">abs1</a> <a id="1849" class="Symbol">=</a> <a id="1851" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1855" href="Reflection.AST.Abstraction.html#1855" class="Bound">s</a> <a id="1857" href="Reflection.AST.Abstraction.html#1857" class="Bound">a</a><a id="1858" class="Symbol">}</a> <a id="1860" class="Symbol">{</a><a id="1861" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1865" href="Reflection.AST.Abstraction.html#1865" class="Bound">t</a> <a id="1867" href="Reflection.AST.Abstraction.html#1867" class="Bound">a′</a><a id="1869" class="Symbol">}</a> <a id="1871" href="Reflection.AST.Abstraction.html#1871" class="Bound">a≟a′</a> <a id="1876" class="Symbol">=</a>
  <a id="1880" href="Relation.Nullary.Decidable.Core.html#4788" class="Function">map′</a> <a id="1885" class="Symbol">(</a><a id="1886" href="Data.Product.Base.html#2609" class="Function">uncurry</a> <a id="1894" class="Symbol">(</a><a id="1895" href="Relation.Binary.PropositionalEquality.Core.html#1390" class="Function">cong₂</a> <a id="1901" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a><a id="1904" class="Symbol">))</a> <a id="1907" href="Reflection.AST.Abstraction.html#1360" class="Function">abs-injective</a> <a id="1921" class="Symbol">(</a><a id="1922" href="Reflection.AST.Abstraction.html#1855" class="Bound">s</a> <a id="1924" href="Data.String.Properties.html#2294" class="Function Operator">String.≟</a> <a id="1933" href="Reflection.AST.Abstraction.html#1865" class="Bound">t</a> <a id="1935" href="Relation.Nullary.Decidable.Core.html#2264" class="Function Operator">×-dec</a> <a id="1941" href="Reflection.AST.Abstraction.html#1871" class="Bound">a≟a′</a><a id="1945" class="Symbol">)</a>

<a id="≡-dec"></a><a id="1948" href="Reflection.AST.Abstraction.html#1948" class="Function">≡-dec</a> <a id="1954" class="Symbol">:</a> <a id="1956" href="Relation.Binary.Definitions.html#6217" class="Function">DecidableEquality</a> <a id="1974" href="Reflection.AST.Abstraction.html#744" class="Generalizable">A</a> <a id="1976" class="Symbol">→</a> <a id="1978" href="Relation.Binary.Definitions.html#6217" class="Function">DecidableEquality</a> <a id="1996" class="Symbol">(</a><a id="1997" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="2001" href="Reflection.AST.Abstraction.html#744" class="Generalizable">A</a><a id="2002" class="Symbol">)</a>
<a id="2004" href="Reflection.AST.Abstraction.html#1948" class="Function">≡-dec</a> <a id="2010" href="Reflection.AST.Abstraction.html#2010" class="Bound Operator">_≟_</a> <a id="2014" href="Reflection.AST.Abstraction.html#2014" class="Bound">x</a> <a id="2016" href="Reflection.AST.Abstraction.html#2016" class="Bound">y</a> <a id="2018" class="Symbol">=</a> <a id="2020" href="Reflection.AST.Abstraction.html#1749" class="Function">unAbs-dec</a> <a id="2030" class="Symbol">(</a><a id="2031" href="Reflection.AST.Abstraction.html#1710" class="Function">unAbs</a> <a id="2037" href="Reflection.AST.Abstraction.html#2014" class="Bound">x</a> <a id="2039" href="Reflection.AST.Abstraction.html#2010" class="Bound Operator">≟</a> <a id="2041" href="Reflection.AST.Abstraction.html#1710" class="Function">unAbs</a> <a id="2047" href="Reflection.AST.Abstraction.html#2016" class="Bound">y</a><a id="2048" class="Symbol">)</a>
</pre></body></html>